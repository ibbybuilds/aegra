{
  "openapi": "3.0.0",
  "info": {
    "title": "Dedatahub API",
    "description": "AI-Driven LMS Backend API",
    "version": "1.0.0"
  },
  "servers": [
    { "url": "https://dedatahub-api.vercel.app/", "description": "Production" },
    { "url": "http://localhost:5000", "description": "Local" }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "TrackStat": {
        "type": "object",
        "properties": {
          "track": {
            "type": "string",
            "description": "The track key (e.g. data-engineering)"
          },
          "total": {
            "type": "integer",
            "description": "Total number of subscriptions"
          },
          "active": { "type": "integer" },
          "canceled": { "type": "integer" },
          "expired": { "type": "integer" },
          "revenue": {
            "type": "number",
            "description": "Total revenue for this track"
          }
        }
      }
    }
  },
  "paths": {
    "/api/v1/admin/invite": {
      "post": {
        "summary": "Invite an admin (superadmin only)",
        "tags": ["Admin"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["name", "email", "role"],
                "properties": {
                  "name": { "type": "string" },
                  "email": { "type": "string" },
                  "role": {
                    "type": "string",
                    "enum": [
                      "admin_finance",
                      "admin_support",
                      "admin_facilitator",
                      "admin_manager"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Invite sent" } }
      }
    },
    "/api/v1/admin/accept-invite": {
      "post": {
        "summary": "Accept admin invite and set password",
        "tags": ["Admin"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["token", "password"],
                "properties": {
                  "token": { "type": "string" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Admin account activated and token returned"
          },
          "400": { "description": "Invalid or expired token" }
        }
      }
    },
    "/api/v1/admin/change-role": {
      "patch": {
        "summary": "Change an admin's role (superadmin only)",
        "tags": ["Admin"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["id", "newRole"],
                "properties": {
                  "id": { "type": "string" },
                  "newRole": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Admin role updated" },
          "400": { "description": "Invalid input" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/status": {
      "get": {
        "summary": "Get AI Mentor onboarding status for the current user",
        "description": "Returns overall onboarding completion, completed steps, current learning track,\nand a computed progress percentage for the wizard.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Status returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/me": {
      "get": {
        "summary": "Get full AI Mentor onboarding document",
        "description": "Returns the raw onboarding document for the authenticated user.\nUse this to resume the wizard or prefill the UI.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Onboarding document returned" },
          "404": { "description": "Onboarding not found" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/mentor-payload": {
      "get": {
        "summary": "Get normalized onboarding payload for the AI Mentor",
        "description": "Returns a clean, finalized payload only if onboarding is completed.\nThis is the structure your AI Mentor service should consume.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Normalized payload returned" },
          "400": { "description": "Onboarding not completed" },
          "404": { "description": "Onboarding not found" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-1": {
      "put": {
        "summary": "Section 1 — Quick Start Profile (Q1–Q4)",
        "description": "Saves Section 1 and optionally sets the student's learning track.\nRequired field: learningTrack on first save.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "learningTrack": {
                    "type": "string",
                    "enum": [
                      "data-analytics",
                      "data-science",
                      "data-engineering",
                      "ai-engineering"
                    ]
                  },
                  "situation": { "type": "string" },
                  "weeklyTime": { "type": "string" },
                  "learningStyle": {
                    "type": "array",
                    "items": { "type": "string" }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 1 saved or updated" },
          "400": { "description": "learningTrack missing on first save" },
          "404": {
            "description": "Onboarding not found (should not occur on first save)"
          }
        }
      },
      "get": {
        "summary": "Get Quick Start Profile (Section 1)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Section 1 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-2": {
      "put": {
        "summary": "Section 2 — Background Story (Q5–Q9)",
        "description": "Saves Section 2 (employment status, role details, industry, and experience).\nRequires Section 1 to be completed first.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "employmentStatus": { "type": "string" },
                  "roleTitle": { "type": "string" },
                  "roleSummary": { "type": "string" },
                  "industry": { "type": "string" },
                  "yearsExperience": { "type": "string" },
                  "yearsTech": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 2 saved" },
          "400": { "description": "Section 1 not completed" },
          "404": { "description": "Onboarding not found" }
        }
      },
      "get": {
        "summary": "Get Employment Background (Section 2)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "section 2 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-3": {
      "put": {
        "summary": "Section 3 — Educational Foundation (Q10–Q12)",
        "description": "Saves Section 3 (highest education, field of study, how you discovered AI).\nRequires Section 2 to be completed first.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "highestEducation": { "type": "string" },
                  "fieldOfStudy": { "type": "string" },
                  "discoveredAI": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 3 saved" },
          "400": { "description": "Section 2 not completed" },
          "404": { "description": "Onboarding not found" }
        }
      },
      "get": {
        "summary": "Get Education & Discovery (Section 3)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Section 3 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-4": {
      "put": {
        "summary": "Section 4 — Goals & Aspirations (Q13–Q16)",
        "description": "Saves Section 4 (primary goal, target role, timeline, and motivation).\nRequires Section 3 to be completed first.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "primaryGoal": { "type": "string" },
                  "targetRole": { "type": "string" },
                  "timeline": { "type": "string" },
                  "goalWhy": { "type": "string", "maxLength": 1000 }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 4 saved" },
          "400": { "description": "Section 3 not completed" },
          "404": { "description": "Onboarding not found" }
        }
      },
      "get": {
        "summary": "Get Career Goals (Section 4)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Section 4 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-5": {
      "put": {
        "summary": "Section 5 — Skills Assessment (Q17–Q19)",
        "description": "Saves Section 5 (confident skills, help areas, and profile URLs).\nRequires Section 4 to be completed first.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "confidentSkills": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "needHelpAreas": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "profiles": {
                    "type": "object",
                    "properties": {
                      "linkedin": { "type": "string" },
                      "github": { "type": "string" },
                      "portfolio": { "type": "string" },
                      "kaggle": { "type": "string" }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 5 saved" },
          "400": { "description": "Section 4 not completed" },
          "404": { "description": "Onboarding not found" }
        }
      },
      "get": {
        "summary": "Get Skills & Profiles (Section 5)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Section 5 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-6": {
      "put": {
        "summary": "Section 6 — Current Challenges (Q20–Q22)",
        "description": "Saves Section 6 (biggest challenge, job search metrics, and a stuck example).\nRequires Section 5 to be completed first.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "biggestChallenge": { "type": "string" },
                  "jobSearch": {
                    "type": "object",
                    "properties": {
                      "appsSubmitted": { "type": "string" },
                      "interviews": { "type": "string" }
                    }
                  },
                  "stuckExample": { "type": "string", "maxLength": 1000 }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 6 saved" },
          "400": { "description": "Section 5 not completed" },
          "404": { "description": "Onboarding not found" }
        }
      },
      "get": {
        "summary": "Get Challenges & Job Search (Section 6)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Section 5 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-track": {
      "put": {
        "summary": "Track-specific (Q23–Q24)",
        "description": "Send only the object that matches the student's track.\n- analytics -> { domains: string[], tools: string[] }\n- dataScience -> { areas: string[], type: string }\n- dataEngineering -> { aspects: string[], stackFocus: string }\n- aiEngineering -> { specializations: string[], buildIntent: string[] }\nRequires Section 6 to be completed first.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  {
                    "type": "object",
                    "properties": {
                      "analytics": {
                        "type": "object",
                        "properties": {
                          "domains": {
                            "type": "array",
                            "items": { "type": "string" }
                          },
                          "tools": {
                            "type": "array",
                            "items": { "type": "string" }
                          }
                        }
                      }
                    }
                  },
                  {
                    "type": "object",
                    "properties": {
                      "dataScience": {
                        "type": "object",
                        "properties": {
                          "areas": {
                            "type": "array",
                            "items": { "type": "string" }
                          },
                          "type": { "type": "string" }
                        }
                      }
                    }
                  },
                  {
                    "type": "object",
                    "properties": {
                      "dataEngineering": {
                        "type": "object",
                        "properties": {
                          "aspects": {
                            "type": "array",
                            "items": { "type": "string" }
                          },
                          "stackFocus": { "type": "string" }
                        }
                      }
                    }
                  },
                  {
                    "type": "object",
                    "properties": {
                      "aiEngineering": {
                        "type": "object",
                        "properties": {
                          "specializations": {
                            "type": "array",
                            "items": { "type": "string" }
                          },
                          "buildIntent": {
                            "type": "array",
                            "items": { "type": "string" }
                          }
                        }
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Track-specific section saved" },
          "400": { "description": "Prerequisite not met" },
          "404": { "description": "Onboarding not found" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-7": {
      "put": {
        "summary": "Section 7 — Learning Preferences & Commitment (Q25–Q28)",
        "description": "Saves Section 7 (feedback style, availability windows, motivators, and risk tolerance).\nRequires Track-specific section to be completed first.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "feedbackStyle": { "type": "string" },
                  "availability": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "motivators": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "riskTolerance": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 7 saved" },
          "400": { "description": "Prerequisite not met" },
          "404": { "description": "Onboarding not found" }
        }
      },
      "get": {
        "summary": "Get Personal Preferences (Section 7)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Section 7 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/section-8": {
      "put": {
        "summary": "Section 8 — Final Thoughts (Q29–Q30)",
        "description": "Saves Section 8 (transformational outcome and any other notes).\nRequires Section 7 to be completed first. Marks onboarding as completed.\n",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "transformationalOutcome": {
                    "type": "string",
                    "maxLength": 1000
                  },
                  "otherNotes": { "type": "string", "maxLength": 1000 }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Section 8 saved; onboarding completed" },
          "400": { "description": "Prerequisite not met" },
          "404": { "description": "Onboarding not found" }
        }
      },
      "get": {
        "summary": "Get Final Outcomes (Section 8)",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Section 8 returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/ai-mentor/onboarding/track": {
      "get": {
        "summary": "Get Track-Specific Details",
        "tags": ["AI Mentor Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Track returned" },
          "404": { "description": "Onboarding not found for this user" }
        }
      }
    },
    "/api/v1/courses/{courseId}/levels/{levelTitle}/modules/{moduleIndex}/assessment": {
      "patch": {
        "summary": "Update assessment for a specific module",
        "tags": ["Assessments"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "schema": { "type": "string" },
            "required": true
          },
          {
            "in": "path",
            "name": "levelTitle",
            "schema": { "type": "string" },
            "required": true
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "schema": { "type": "integer" },
            "required": true
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "questions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "question": { "type": "string" },
                        "options": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "correctAnswer": { "type": "string" }
                      }
                    }
                  },
                  "timeLimit": { "type": "number" },
                  "passMark": { "type": "number" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Assessment updated successfully" },
          "404": { "description": "Course, level, or module not found" }
        }
      },
      "post": {
        "summary": "Create assessment for a specific module",
        "tags": ["Assessments"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["questions"],
                "properties": {
                  "questions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "question": { "type": "string" },
                        "options": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "correctAnswer": { "type": "string" }
                      }
                    }
                  },
                  "timeLimit": { "type": "number" },
                  "passMark": { "type": "number" }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Assessment created successfully" },
          "400": { "description": "Assessment already exists" },
          "404": { "description": "Course or level or module not found" }
        }
      },
      "delete": {
        "summary": "Delete assessment from a specific module",
        "tags": ["Assessments"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "schema": { "type": "string" },
            "required": true
          },
          {
            "in": "path",
            "name": "levelTitle",
            "schema": { "type": "string" },
            "required": true
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "schema": { "type": "integer" },
            "required": true
          }
        ],
        "responses": {
          "200": { "description": "Assessment deleted successfully" },
          "404": { "description": "Course, level, or module not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/{levelTitle}/{moduleIndex}/project": {
      "post": {
        "summary": "Create a new project for a specific course module",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "The ID of the course"
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "The title of the level"
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" },
            "description": "The index of the module"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "instructions": { "type": "string" },
                  "required": { "type": "boolean" },
                  "acceptedTypes": {
                    "type": "array",
                    "items": { "type": "string" },
                    "example": ["document", "image", "link"]
                  },
                  "submissionDeadline": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "sampleFileUrl": { "type": "string", "format": "uri" },
                  "file": { "type": "string", "format": "binary" }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Project created successfully" },
          "400": { "description": "Bad request or project already exists" },
          "500": { "description": "Internal server error" }
        }
      },
      "patch": {
        "summary": "Update an existing module project",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "instructions": { "type": "string" },
                  "required": { "type": "boolean" },
                  "acceptedTypes": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "submissionDeadline": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "sampleFileUrl": { "type": "string", "format": "uri" },
                  "file": { "type": "string", "format": "binary" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Project updated successfully" },
          "404": { "description": "Project or module not found" },
          "500": { "description": "Internal server error" }
        }
      },
      "delete": {
        "summary": "Delete project from a module",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": { "description": "Project deleted successfully" },
          "404": { "description": "Course, level, or module not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/{levelTitle}/{moduleIndex}/project/submit": {
      "post": {
        "summary": "Submit a module project as a student",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "link": { "type": "string", "format": "uri" },
                  "notes": { "type": "string" },
                  "file": { "type": "string", "format": "binary" }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Project submitted successfully" },
          "400": {
            "description": "Submission error (e.g., already submitted or unsupported type)"
          },
          "500": { "description": "Internal server error" }
        }
      }
    },
    "/api/v1/courses/projects/review/{submissionId}": {
      "patch": {
        "summary": "Review and provide feedback on a student's project",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "submissionId",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "feedback": { "type": "string" },
                  "reviewed": {
                    "type": "boolean",
                    "example": "Well done, but please imporve X in your next submission."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Review updated" },
          "404": { "description": "Submission not found" }
        }
      }
    },
    "/api/v1/courses/projects/resubmit/{submissionId}": {
      "patch": {
        "summary": "Resubmit a previously submitted project",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "submissionId",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fileUrl": { "type": "string" },
                  "notes": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Project resubmitted successfully" },
          "403": { "description": "Unauthorized" },
          "404": { "description": "Submission not found" }
        }
      }
    },
    "/api/v1/courses/projects/my-submissions": {
      "get": {
        "summary": "Get logged-in student's project submissions",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "List of project submissions" },
          "401": { "description": "Unauthorized" }
        }
      }
    },
    "/api/v1/courses/projects/submissions": {
      "get": {
        "summary": "Get all project submissions (Admin only)",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "List of project submissions" },
          "401": { "description": "Unauthorized" }
        }
      }
    },
    "/api/v1/courses/projects/student/{studentId}": {
      "get": {
        "summary": "Get all project submissions for a specific student (Admin only)",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "studentId",
            "required": true,
            "schema": { "type": "string" },
            "description": "The student's user ID"
          }
        ],
        "responses": {
          "200": { "description": "Student project submissions" },
          "404": { "description": "No submissions found" }
        }
      }
    },
    "/api/v1courses/projects/{courseId}/{levelTitle}/{moduleIndex}/submissions": {
      "get": {
        "summary": "Get all project submissions for a specific module",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": { "description": "List of submissions returned" },
          "500": { "description": "Internal server error" }
        }
      }
    },
    "/api/v1/courses/projects/{id}": {
      "get": {
        "summary": "Get a single project submission by ID (Admin only)",
        "tags": ["Projects"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "string" },
            "description": "Project submission ID"
          }
        ],
        "responses": {
          "200": { "description": "Project submission data" },
          "404": { "description": "Submission not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/levels/{levelTitle}/assessment": {
      "patch": {
        "summary": "Update level assessment",
        "tags": ["Assessments"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "questions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "question": { "type": "string" },
                        "options": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "correctAnswer": { "type": "string" }
                      }
                    }
                  },
                  "timeLimit": { "type": "number" },
                  "passMark": { "type": "number" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Assessment updated" },
          "404": { "description": "Not found" }
        }
      },
      "get": {
        "summary": "Get assessment questions for a level",
        "tags": ["Levels"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "in": "path", "name": "courseId", "required": true },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "enum": ["Beginner", "Intermediate", "Advanced"]
          }
        ],
        "responses": {
          "200": { "description": "Assessment questions fetched" }
        }
      },
      "post": {
        "summary": "Create final assessment for a course level",
        "tags": ["Assessments"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["questions"],
                "properties": {
                  "questions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "question": { "type": "string" },
                        "options": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "correctAnswer": { "type": "string" }
                      }
                    }
                  },
                  "timeLimit": { "type": "number" },
                  "passMark": { "type": "number" }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Level assessment created successfully" },
          "400": { "description": "Assessment already exists" },
          "404": { "description": "Course or level not found" }
        }
      },
      "delete": {
        "summary": "Delete level assessment",
        "tags": ["Assessments"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "Assessment deleted" },
          "404": { "description": "Not found" }
        }
      }
    },
    "/api/v1/auth/register": {
      "post": {
        "summary": "Register a student",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["name", "email", "password"],
                "properties": {
                  "name": { "type": "string" },
                  "email": { "type": "string" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "User registered and verification code sent" }
        }
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "summary": "Login a verified User",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "password"],
                "properties": {
                  "email": { "type": "string" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Successful login" } }
      }
    },
    "/api/v1/auth/google": {
      "get": {
        "summary": "Start Google OAuth login",
        "description": "Redirects user to Google login consent screen for authentication.",
        "tags": ["Auth"],
        "responses": { "302": { "description": "Redirect to Google login" } }
      }
    },
    "/api/v1/auth/google/callback": {
      "get": {
        "summary": "Google OAuth callback",
        "description": "Handles Google login callback, creates or logs in user, returns access token and sets refresh token cookie.",
        "tags": ["Auth"],
        "responses": {
          "302": { "description": "Redirects to frontend with access token" }
        }
      }
    },
    "/api/v1/auth/facebook": {
      "get": {
        "summary": "Start Facebook OAuth login",
        "tags": ["Auth"],
        "responses": { "302": { "description": "Redirect to Facebook login" } }
      }
    },
    "/api/v1/auth/facebook/callback": {
      "get": {
        "summary": "Facebook OAuth callback",
        "tags": ["Auth"],
        "responses": {
          "302": {
            "description": "Redirect to frontend onboarding with access token"
          }
        }
      }
    },
    "/api/v1/auth/apple": {
      "get": {
        "summary": "Start Apple OAuth login",
        "tags": ["Auth"],
        "responses": { "302": { "description": "Redirect to Apple login" } }
      }
    },
    "/api/v1/auth/apple/callback": {
      "get": {
        "summary": "Apple OAuth callback",
        "tags": ["Auth"],
        "responses": {
          "302": { "description": "Redirect to onboarding with access token" }
        }
      }
    },
    "/api/v1/auth/verify-email": {
      "post": {
        "summary": "Verify email with a code",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "code"],
                "properties": {
                  "email": { "type": "string" },
                  "code": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Email verified successfully" } }
      }
    },
    "/api/v1/auth/resend-verification": {
      "post": {
        "summary": "Resend the email verification code",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email"],
                "properties": { "email": { "type": "string" } }
              }
            }
          }
        },
        "responses": { "200": { "description": "Verification code resent" } }
      }
    },
    "/api/v1/auth/refresh-token": {
      "get": {
        "summary": "Refresh the access token using refresh token (cookie)",
        "tags": ["Auth"],
        "responses": {
          "200": { "description": "Returns new access token" },
          "401": { "description": "Refresh token missing or invalid" }
        }
      }
    },
    "/api/v1/auth/change-password": {
      "post": {
        "summary": "Change password (for any logged-in user)",
        "tags": ["Auth"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["currentPassword", "newPassword"],
                "properties": {
                  "currentPassword": {
                    "type": "string",
                    "example": "oldPass123"
                  },
                  "newPassword": {
                    "type": "string",
                    "example": "newSecurePass456"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Password updated successfully" },
          "401": { "description": "Incorrect current password" }
        }
      }
    },
    "/api/v1/auth/forget-password": {
      "post": {
        "summary": "Send password reset email",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email"],
                "properties": { "email": { "type": "string" } }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Reset link sent" },
          "404": { "description": "User not found" }
        }
      }
    },
    "/api/v1/auth/reset-password": {
      "post": {
        "summary": "Reset password using token",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["token", "password"],
                "properties": {
                  "token": { "type": "string" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Password has been reset successfully" },
          "400": { "description": "Invalid or expired token" }
        }
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "summary": "Logout user and clear refresh token cookie",
        "tags": ["Auth"],
        "responses": { "200": { "description": "Successfully logged out" } }
      }
    },
    "/api/v1/enrollment/": {
      "get": {
        "summary": "Get student's active track/course subscriptions",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "List of active subscriptions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "subscriptions": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "planType": { "type": "string" },
                          "track": {
                            "type": "object",
                            "properties": {
                              "id": { "type": "string" },
                              "title": { "type": "string" }
                            }
                          },
                          "duration": { "type": "string" },
                          "startDate": { "type": "string" },
                          "endDate": { "type": "string" },
                          "aiMentorIncluded": { "type": "boolean" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "No active subscriptions found" }
        }
      }
    },
    "/api/v1/enrollment/{courseId}/structure": {
      "get": {
        "summary": "Get structured view of student's course progress",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "Course ID from the student's enrollment"
          }
        ],
        "responses": {
          "200": {
            "description": "Course structure and progress",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "courseTitle": { "type": "string" },
                    "levels": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "levelTitle": { "type": "string" },
                          "unlocked": { "type": "boolean" },
                          "assessmentPassed": { "type": "boolean" },
                          "modules": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "moduleTitle": { "type": "string" },
                                "completed": { "type": "boolean" },
                                "unlocked": { "type": "boolean" },
                                "assessmentPassed": { "type": "boolean" },
                                "lessons": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "lessonId": { "type": "string" },
                                      "title": { "type": "string" },
                                      "completed": { "type": "boolean" },
                                      "unlocked": { "type": "boolean" }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "nextLessonToContinue": {
                      "type": "object",
                      "properties": {
                        "lessonId": { "type": "string" },
                        "title": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "Enrollment or course not found" }
        }
      }
    },
    "/api/v1/enrollment/student/blackboard": {
      "get": {
        "summary": "Get all enrolled courses with progress and AI mentor info",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "List of enrolled courses with progress details",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "enrollments": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "enrollmentId": { "type": "string" },
                          "course": {
                            "type": "object",
                            "properties": {
                              "_id": { "type": "string" },
                              "title": { "type": "string" },
                              "slug": { "type": "string" },
                              "track": { "type": "string" },
                              "imageUrl": { "type": "string" },
                              "levels": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "title": { "type": "string" }
                                  }
                                }
                              }
                            }
                          },
                          "overallProgress": { "type": "number" },
                          "finalAssessmentPassed": { "type": "boolean" },
                          "aiMentor": {
                            "type": "object",
                            "nullable": true,
                            "properties": {
                              "billingCycle": { "type": "string" },
                              "expiresAt": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "status": { "type": "string" }
                            }
                          },
                          "nextModule": {
                            "type": "object",
                            "nullable": true,
                            "properties": {
                              "level": { "type": "string" },
                              "moduleTitle": { "type": "string" }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": { "description": "Failed to load student dashboard" }
        }
      }
    },
    "/api/v1/enrollment/course/{courseId}/lesson/{lessonId}/progress": {
      "patch": {
        "summary": "Update lesson watched percentage and completion",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "lessonId",
            "required": true,
            "schema": { "type": "string" },
            "description": "Lesson ID to update progress for"
          },
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "Course ID to update progress for"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "watchedPercentage": { "type": "number", "example": 85 }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Progress updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" },
                    "overallProgress": { "type": "number" }
                  }
                }
              }
            }
          },
          "404": { "description": "Enrollment or lesson not found" }
        }
      }
    },
    "/api/v1/enrollment/level/{levelTitle}/test-out": {
      "post": {
        "summary": "Attempt to test out of a course level",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "Title of the level (e.g., Beginner, Intermediate)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["courseId", "answers"],
                "properties": {
                  "courseId": { "type": "string" },
                  "answers": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "questionId": { "type": "string" },
                        "selectedOption": {
                          "type": "array",
                          "items": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Test-out result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "passed": { "type": "boolean" },
                    "score": { "type": "number" },
                    "message": { "type": "string" }
                  }
                }
              }
            }
          },
          "404": { "description": "Course, enrollment, or level not found" }
        }
      }
    },
    "/api/v1/enrollment/module/{moduleTitle}/submit-assessment": {
      "post": {
        "summary": "Submit module assessment and update progress",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "moduleTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "Title of the module (e.g., Introduction to SQL)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["courseId", "levelTitle", "answers"],
                "properties": {
                  "courseId": { "type": "string" },
                  "levelTitle": { "type": "string" },
                  "answers": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "questionId": { "type": "string" },
                        "selectedOption": {
                          "type": "array",
                          "items": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Module assessment result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "passed": { "type": "boolean" },
                    "score": { "type": "number" },
                    "message": { "type": "string" }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Course, level, module, or enrollment not found"
          }
        }
      }
    },
    "/api/v1/enrollment/level/{levelTitle}/submit-assessment": {
      "post": {
        "summary": "Submit level assessment for completion and certificate",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "Title of the level (e.g., Beginner, Intermediate)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["courseId", "answers"],
                "properties": {
                  "courseId": { "type": "string" },
                  "answers": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "questionId": { "type": "string" },
                        "selectedOption": {
                          "type": "array",
                          "items": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Level assessment result and certificate issuance",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "passed": { "type": "boolean" },
                    "score": { "type": "number" },
                    "certificateUrl": { "type": "string", "nullable": true },
                    "message": { "type": "string" }
                  }
                }
              }
            }
          },
          "404": { "description": "Course, enrollment, or level not found" }
        }
      }
    },
    "/api/v1/enrollment/{studentId}/attempts": {
      "get": {
        "summary": "Get all assessment attempts of a student",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "studentId",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the student"
          }
        ],
        "responses": {
          "200": {
            "description": "List of assessment attempts with summary",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "studentId": { "type": "string" },
                    "summary": {
                      "type": "object",
                      "properties": {
                        "totalAttempts": { "type": "integer" },
                        "finalScore": { "type": "integer" },
                        "timeToPass": {
                          "type": "integer",
                          "description": "Time in minutes from first attempt to first pass"
                        }
                      }
                    },
                    "attempts": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "_id": { "type": "string" },
                          "course": { "type": "string" },
                          "levelTitle": { "type": "string" },
                          "moduleTitle": { "type": "string", "nullable": true },
                          "score": { "type": "integer" },
                          "passed": { "type": "boolean" },
                          "attemptType": {
                            "type": "string",
                            "enum": ["module", "level"]
                          },
                          "duration": {
                            "type": "integer",
                            "nullable": true,
                            "description": "Duration in minutes"
                          },
                          "submittedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "Student not found" },
          "500": { "description": "Failed to fetch assessment attempts" }
        }
      }
    },
    "/api/v1/enrollment/{courseId}/certificates": {
      "get": {
        "summary": "Get list of issued certificates for a course",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "Course ID for which certificates are issued"
          }
        ],
        "responses": {
          "200": {
            "description": "List of certificates per completed level",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "certificates": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "levelTitle": { "type": "string" },
                          "issuedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "certificateUrl": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Enrollment not found or no certificates issued"
          }
        }
      }
    },
    "/api/v1/enrollment/certificate/{id}": {
      "get": {
        "summary": "Get a certificate by enrollment ID (admin or student)",
        "tags": ["Blackboard"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "string" },
            "description": "Enrollment ID containing the certificate"
          }
        ],
        "responses": {
          "200": {
            "description": "Certificate data with student and course info"
          },
          "403": { "description": "Unauthorized access" },
          "404": { "description": "Enrollment not found" }
        }
      }
    },
    "/api/v1/courses": {
      "post": {
        "summary": "Create a new course",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["title", "track", "levels"],
                "properties": {
                  "title": { "type": "string" },
                  "subtitle": { "type": "string" },
                  "description": { "type": "string" },
                  "overview": { "type": "string" },
                  "keyHighlights": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "outcomeGoals": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "duration": { "type": "string" },
                  "track": {
                    "type": "string",
                    "enum": [
                      "data-analytics",
                      "data-engineering",
                      "data-science",
                      "ai-engineering"
                    ]
                  },
                  "pricing": {
                    "type": "object",
                    "properties": {
                      "monthly": { "type": "number" },
                      "oneTime": { "type": "number" }
                    }
                  },
                  "image": {
                    "type": "string",
                    "description": "base64 string or Cloudinary URL"
                  },
                  "levels": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["title"],
                      "properties": {
                        "title": {
                          "type": "string",
                          "enum": ["Beginner", "Intermediate", "Advanced"]
                        },
                        "modules": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "title": { "type": "string" },
                              "description": { "type": "string" },
                              "estimatedDuration": { "type": "string" },
                              "facilitator": { "type": "string" },
                              "lessons": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "title": { "type": "string" },
                                    "videoUrl": { "type": "string" },
                                    "transcript": { "type": "string" },
                                    "quiz": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "question": { "type": "string" },
                                          "options": {
                                            "type": "array",
                                            "items": { "type": "string" }
                                          },
                                          "correctAnswer": { "type": "string" }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        },
                        "assessment": {
                          "type": "object",
                          "properties": {
                            "questions": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "question": { "type": "string" },
                                  "options": {
                                    "type": "array",
                                    "items": { "type": "string" }
                                  },
                                  "correctAnswer": { "type": "string" }
                                }
                              }
                            },
                            "passMark": { "type": "number" }
                          }
                        },
                        "certificateUrl": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Course created" },
          "500": { "description": "Server error" }
        }
      },
      "get": {
        "summary": "Get all courses (admin gets all, others only published)",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string",
              "enum": ["published", "draft", "all"]
            },
            "description": "Filter courses by publication status. Admins only."
          }
        ],
        "responses": {
          "200": { "description": "List of filtered courses" },
          "400": { "description": "Invalid status filter" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/courses/{courseId}/levels/{levelTitle}/modules/{moduleIndex}/lessons/{lessonIndex}/materials": {
      "post": {
        "summary": "Upload lesson material (PDF, PPT, DOC, etc.)",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "consumes": ["multipart/form-data"],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "The ID of the course"
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "Title of the course level"
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" },
            "description": "Index of the module within the level"
          },
          {
            "in": "path",
            "name": "lessonIndex",
            "required": true,
            "schema": { "type": "integer" },
            "description": "Index of the lesson within the module"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "The file to upload"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Material uploaded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": { "message": { "type": "string" } }
                }
              }
            }
          },
          "400": { "description": "Bad request (e.g. file not provided)" },
          "500": { "description": "Server error" }
        }
      },
      "get": {
        "summary": "Get all materials for a specific lesson",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" }
          },
          {
            "in": "path",
            "name": "lessonIndex",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": { "description": "Lesson materials retrieved successfully" },
          "404": {
            "description": "Course, level, module, or lesson not found"
          },
          "500": { "description": "Internal server error" }
        }
      }
    },
    "/api/v1/courses/{courseId}/materials": {
      "get": {
        "summary": "Get all lesson materials in a course",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "The ID of the course"
          }
        ],
        "responses": {
          "200": {
            "description": "All materials retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "courseId": { "type": "string" },
                    "courseTitle": { "type": "string" },
                    "totalMaterials": { "type": "integer" },
                    "materials": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "levelTitle": { "type": "string" },
                          "moduleTitle": { "type": "string" },
                          "lessonTitle": { "type": "string" },
                          "lessonId": { "type": "string" },
                          "fileUrl": { "type": "string" },
                          "fileType": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "Course not found" },
          "500": { "description": "Internal server error" }
        }
      }
    },
    "/api/v1/courses/{courseId}/{levelTitle}/{moduleIndex}/{lessonIndex}/materials/{materialIndex}": {
      "delete": {
        "summary": "Delete a material from a lesson",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the course"
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "Title of the level"
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" },
            "description": "Index of the module in the level"
          },
          {
            "in": "path",
            "name": "lessonIndex",
            "required": true,
            "schema": { "type": "integer" },
            "description": "Index of the lesson in the module"
          },
          {
            "in": "path",
            "name": "materialIndex",
            "required": true,
            "schema": { "type": "integer" },
            "description": "Index of the material to delete"
          }
        ],
        "responses": {
          "200": { "description": "Material deleted successfully" },
          "404": {
            "description": "Course, level, module, lesson, or material not found"
          },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/courses/{id}": {
      "get": {
        "summary": "Get a course by ID",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "Course retrieved successfully" },
          "404": { "description": "Course not found" }
        }
      },
      "put": {
        "summary": "Update a course by ID",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": { "type": "string" },
            "required": true,
            "description": "The ID of the course"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "subtitle": { "type": "string" },
                  "description": { "type": "string" },
                  "overview": { "type": "string" },
                  "keyHighlights": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "outcomeGoals": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "duration": { "type": "string" },
                  "track": { "type": "string" },
                  "pricing": {
                    "type": "object",
                    "properties": {
                      "monthly": { "type": "number" },
                      "oneTime": { "type": "number" }
                    }
                  },
                  "image": { "type": "string" },
                  "isPublished": { "type": "boolean" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Course updated successfully" },
          "403": { "description": "Unauthorized" },
          "404": { "description": "Course not found" },
          "500": { "description": "Server error" }
        }
      },
      "delete": {
        "summary": "Delete a course by ID",
        "tags": ["Courses"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": { "type": "string" },
            "required": true,
            "description": "The course ID"
          }
        ],
        "responses": {
          "200": { "description": "Course deleted" },
          "403": { "description": "Unauthorized" },
          "404": { "description": "Course not found" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/courses/c/{slug}": {
      "get": {
        "summary": "Get a course by slug",
        "tags": ["Courses"],
        "parameters": [
          {
            "in": "path",
            "name": "slug",
            "schema": { "type": "string" },
            "required": true,
            "description": "The course slug"
          }
        ],
        "responses": {
          "200": { "description": "Course data" },
          "404": { "description": "Course not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/modules/{levelTitle}/{moduleIndex}/lessons": {
      "post": {
        "summary": "Add a new lesson to a module",
        "tags": ["Lessons"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "number" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": ["title"],
                "properties": {
                  "title": { "type": "string" },
                  "quiz": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "question": { "type": "string" },
                        "options": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "correctAnswer": { "type": "string" }
                      }
                    }
                  },
                  "duration": { "type": "string" },
                  "video": {
                    "type": "string",
                    "format": "binary",
                    "description": "Upload video file (MP4 format recommended)"
                  },
                  "transcript": {
                    "type": "string",
                    "format": "binary",
                    "description": "Upload transcript file (.txt format only)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Lesson added successfully" },
          "400": { "description": "Bad request" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/courses/{courseId}/lessons": {
      "get": {
        "summary": "Get all lessons in a course grouped by level and module",
        "tags": ["Lessons"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "courseId",
            "in": "path",
            "required": true,
            "description": "The ID of the course",
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Lessons fetched successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "lessons": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "levelTitle": {
                            "type": "string",
                            "example": "Beginner"
                          },
                          "moduleIndex": { "type": "integer", "example": 0 },
                          "lessonIndex": { "type": "integer", "example": 1 },
                          "title": {
                            "type": "string",
                            "example": "Introduction to Data"
                          },
                          "duration": { "type": "string", "example": "12:45" },
                          "transcript": {
                            "type": "string",
                            "example": "Full transcript of the video"
                          },
                          "video": {
                            "type": "object",
                            "properties": {
                              "publicId": { "type": "string" },
                              "secureUrl": { "type": "string" }
                            }
                          },
                          "quiz": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "question": { "type": "string" },
                                "options": {
                                  "type": "array",
                                  "items": { "type": "string" }
                                },
                                "correctAnswer": { "type": "string" }
                              }
                            }
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "Course not found" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/courses/{courseId}/{levelTitle}/modules/{moduleIndex}/lessons/{lessonIndex}": {
      "get": {
        "summary": "Get a lesson by its ID from a module in a specific course level",
        "tags": ["Lessons"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "courseId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "The ID of the course"
          },
          {
            "name": "levelTitle",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "The level title (e.g., Beginner, Intermediate, Advanced)"
          },
          {
            "name": "moduleIndex",
            "in": "path",
            "required": true,
            "schema": { "type": "integer" },
            "description": "Index of the module in the specified level"
          },
          {
            "name": "lessonIndex",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "The ID of the lesson"
          }
        ],
        "responses": {
          "200": {
            "description": "Lesson retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "lesson": {
                      "type": "object",
                      "properties": {
                        "_id": { "type": "string" },
                        "title": { "type": "string" },
                        "transcript": { "type": "string" },
                        "video": {
                          "type": "object",
                          "properties": {
                            "publicId": { "type": "string" },
                            "secureUrl": { "type": "string" }
                          }
                        },
                        "quiz": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "question": { "type": "string" },
                              "options": {
                                "type": "array",
                                "items": { "type": "string" }
                              },
                              "correctAnswer": { "type": "string" }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "Lesson not found" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/courses/{courseId}/modules/{levelTitle}/{moduleIndex}/lessons/{lessonIndex}": {
      "put": {
        "summary": "Update an existing lesson",
        "tags": ["Lessons"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "number" }
          },
          {
            "in": "path",
            "name": "lessonIndex",
            "required": true,
            "schema": { "type": "number" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "transcript": { "type": "string" },
                  "quiz": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "question": { "type": "string" },
                        "options": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "correctAnswer": { "type": "string" }
                      }
                    }
                  },
                  "duration": { "type": "string" },
                  "video": {
                    "type": "string",
                    "description": "base64 or new cloudinary upload string"
                  }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Lesson updated" } }
      },
      "delete": {
        "summary": "Delete a lesson",
        "tags": ["Lessons"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "number" }
          },
          {
            "in": "path",
            "name": "lessonIndex",
            "required": true,
            "schema": { "type": "number" }
          }
        ],
        "responses": { "200": { "description": "Lesson deleted" } }
      }
    },
    "/api/v1/courses/{courseId}/levels": {
      "post": {
        "summary": "Add a new level to a course",
        "tags": ["Levels"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the course"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["title"],
                "properties": {
                  "title": {
                    "type": "string",
                    "enum": ["Beginner", "Intermediate", "Advanced"]
                  },
                  "assessment": {
                    "type": "object",
                    "properties": {
                      "questions": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "question": { "type": "string" },
                            "options": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "correctAnswer": { "type": "string" }
                          }
                        }
                      },
                      "timeLimit": { "type": "number" },
                      "passMark": { "type": "number" }
                    }
                  },
                  "certificateUrl": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Level created successfully" },
          "400": { "description": "Level already exists" },
          "404": { "description": "Course not found" }
        }
      },
      "get": {
        "summary": "Get all levels of a specific course",
        "tags": ["Levels"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the course"
          }
        ],
        "responses": {
          "200": { "description": "List of levels for the course" },
          "404": { "description": "Course not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/levels/{levelTitle}": {
      "patch": {
        "summary": "Update a level's assessment or certificate",
        "tags": ["Levels"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "assessment": {
                    "type": "object",
                    "properties": {
                      "questions": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "question": { "type": "string" },
                            "options": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "correctAnswer": { "type": "string" }
                          }
                        }
                      },
                      "timeLimit": { "type": "number" },
                      "passMark": { "type": "number" }
                    }
                  },
                  "certificateUrl": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Level updated successfully" },
          "404": { "description": "Course or level not found" }
        }
      },
      "delete": {
        "summary": "Delete a level from a course",
        "tags": ["Levels"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "Level deleted successfully" },
          "404": { "description": "Course or level not found" }
        }
      }
    },
    "/api/v1/users/certificates": {
      "get": {
        "summary": "Get all certificates earned by the logged-in student",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "List of earned certificates",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "certificates": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "courseTitle": { "type": "string" },
                          "level": { "type": "string" },
                          "certificateUrl": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": { "description": "Failed to fetch certificates" }
        }
      }
    },
    "/api/v1/courses/{courseId}/levels/{levelTitle}/modules": {
      "post": {
        "summary": "Add a new module to a level",
        "tags": ["Modules"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the course"
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "Title of the level (Beginner, Intermediate, Advanced)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["title"],
                "properties": {
                  "title": { "type": "string" },
                  "description": { "type": "string" },
                  "estimatedDuration": { "type": "string" },
                  "facilitator": { "type": "string" },
                  "assessment": {
                    "type": "object",
                    "properties": {
                      "questions": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "question": { "type": "string" },
                            "options": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "correctAnswer": { "type": "string" }
                          }
                        }
                      },
                      "timeLimit": { "type": "number" },
                      "passMark": { "type": "number" }
                    }
                  },
                  "project": {
                    "type": "object",
                    "properties": {
                      "title": { "type": "string" },
                      "instructions": { "type": "string" },
                      "required": { "type": "boolean" }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Module created successfully" },
          "404": { "description": "Course or level not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/levels/{levelTitle}/modules/{moduleIndex}": {
      "patch": {
        "summary": "Update a module in a course level",
        "tags": ["Modules"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "description": { "type": "string" },
                  "estimatedDuration": { "type": "string" },
                  "facilitator": { "type": "string" },
                  "assessment": {
                    "type": "object",
                    "properties": {
                      "questions": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "question": { "type": "string" },
                            "options": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "correctAnswer": { "type": "string" }
                          }
                        }
                      },
                      "timeLimit": { "type": "number" },
                      "passMark": { "type": "number" }
                    }
                  },
                  "project": {
                    "type": "object",
                    "properties": {
                      "title": { "type": "string" },
                      "instructions": { "type": "string" },
                      "required": { "type": "boolean" }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Module updated successfully" },
          "404": { "description": "Module or level not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/modules/{levelTitle}/{moduleIndex}": {
      "delete": {
        "summary": "Delete a module by index in a level",
        "tags": ["Modules"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "schema": { "type": "string" },
            "required": true
          },
          {
            "in": "path",
            "name": "levelTitle",
            "schema": { "type": "string" },
            "required": true
          },
          {
            "in": "path",
            "name": "moduleIndex",
            "schema": { "type": "number" },
            "required": true
          }
        ],
        "responses": { "200": { "description": "Module deleted" } }
      }
    },
    "/api/v1/courses/{courseId}/modules/{levelTitle}/protected": {
      "get": {
        "summary": "Get modules with locked/unlocked status for an enrolled student",
        "tags": ["Modules"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" },
            "description": "Course ID"
          },
          {
            "in": "path",
            "name": "levelTitle",
            "required": true,
            "schema": { "type": "string" },
            "description": "Course level (Beginner, Intermediate, etc.)"
          }
        ],
        "responses": {
          "200": {
            "description": "List of modules with locked flag",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "modules": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "index": { "type": "number" },
                          "title": { "type": "string" },
                          "description": { "type": "string" },
                          "facilitator": { "type": "string" },
                          "estimatedDuration": { "type": "string" },
                          "locked": { "type": "boolean" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "403": { "description": "Not enrolled" },
          "404": { "description": "Course or level not found" }
        }
      }
    },
    "/api/v1/courses/{courseId}/modules": {
      "get": {
        "summary": "Get all modules of a course",
        "tags": ["Modules"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "courseId",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "List of modules",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "modules": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "levelTitle": { "type": "string" },
                          "moduleIndex": { "type": "number" },
                          "title": { "type": "string" },
                          "description": { "type": "string" },
                          "facilitator": { "type": "string" },
                          "estimatedDuration": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "Course not found" }
        }
      }
    },
    "/api/v1/onboarding/track": {
      "post": {
        "summary": "Save phone number and learning track",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["phoneNumber", "learningTrack"],
                "properties": {
                  "phoneNumber": { "type": "string" },
                  "learningTrack": {
                    "type": "string",
                    "enum": [
                      "data-analytics",
                      "data-engineering",
                      "data-science",
                      "ai-engineering"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Track saved" } }
      }
    },
    "/api/v1/onboarding/time-commitment": {
      "post": {
        "summary": "Save time commitment details",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "schedule": { "type": "string" },
                  "hoursPerWeek": { "type": "number" }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Time commitment saved" } }
      }
    },
    "/api/v1/onboarding/learning-preferences": {
      "post": {
        "summary": "Save learning preferences",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "learningStyle": { "type": "string" },
                  "problemSolving": { "type": "string" },
                  "explanationPreference": { "type": "string" },
                  "challenges": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Learning preferences saved" } }
      }
    },
    "/api/v1/onboarding/technical-background": {
      "post": {
        "summary": "Save technical background based on track",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "toolsWorkedWith": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "aiSystemsBuilt": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "experienceLevel": {
                    "type": "object",
                    "additionalProperties": {
                      "type": "string",
                      "description": "Level of experience per subject (e.g. Python, ML, etc.)"
                    }
                  },
                  "performedTasks": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "dataTypes": {
                    "type": "array",
                    "items": { "type": "string" }
                  }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Technical background saved" } }
      }
    },
    "/api/v1/onboarding/skip": {
      "post": {
        "summary": "Skip onboarding process",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "Onboarding skipped" } }
      }
    },
    "/api/v1/onboarding/resume": {
      "post": {
        "summary": "Resume onboarding if previously skipped",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "Onboarding resumed" } }
      }
    },
    "/api/v1/onboarding/status": {
      "get": {
        "summary": "Get onboarding progress status",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Current onboarding status returned" }
        }
      }
    },
    "/api/v1/onboarding": {
      "get": {
        "summary": "Get current user's onboarding data",
        "tags": ["Onboarding"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Onboarding data retrieved successfully" },
          "404": { "description": "Onboarding data not found" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/plans": {
      "post": {
        "summary": "Create a new subscription plan",
        "description": "Creates a new subscription plan. This endpoint is accessible to admins only.",
        "tags": ["Plans"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["type", "title", "description"],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": ["track", "bundle-essential", "bundle-premium"],
                    "description": "Type of subscription plan."
                  },
                  "courseId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Course ID linked to this plan (optional for track plans)."
                  },
                  "track": {
                    "type": "string",
                    "enum": [
                      "data-analytics",
                      "data-engineering",
                      "data-science",
                      "ai-engineering"
                    ],
                    "description": "Track name for track-type plans."
                  },
                  "title": {
                    "type": "string",
                    "description": "Title of the plan."
                  },
                  "description": {
                    "type": "string",
                    "description": "Brief description of the plan."
                  },
                  "pricing": {
                    "type": "object",
                    "description": "Pricing options for different durations.",
                    "properties": {
                      "oneTime": { "type": "number", "example": 5000 },
                      "monthly": { "type": "number", "example": 2000 },
                      "threeMonths": { "type": "number", "example": 5500 },
                      "sixMonths": { "type": "number", "example": 10000 },
                      "oneYear": { "type": "number", "example": 18000 }
                    }
                  },
                  "aiMentorAddOnPricing": {
                    "type": "object",
                    "description": "Optional pricing for AI-Mentor add-on.",
                    "properties": {
                      "monthly": { "type": "number", "example": 1000 },
                      "threeMonths": { "type": "number", "example": 2500 },
                      "sixMonths": { "type": "number", "example": 4500 },
                      "oneYear": { "type": "number", "example": 8000 }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Subscription plan created successfully." },
          "400": { "description": "Invalid input data." },
          "500": { "description": "Server error while creating plan." }
        }
      },
      "get": {
        "summary": "Get all subscription plans",
        "tags": ["Plans"],
        "responses": {
          "200": { "description": "List of plans" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/plans/{id}": {
      "get": {
        "summary": "Get a subscription plan by ID",
        "tags": ["Plans"],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": { "type": "string" },
            "required": true
          }
        ],
        "responses": {
          "200": { "description": "Plan found" },
          "404": { "description": "Plan not found" }
        }
      },
      "patch": {
        "summary": "Update a subscription plan",
        "tags": ["Plans"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": { "type": "string" },
            "required": true
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "type": { "type": "string" },
                  "description": { "type": "string" },
                  "pricing": {
                    "type": "object",
                    "properties": {
                      "oneTime": { "type": "number" },
                      "monthly": { "type": "number" },
                      "threeMonths": { "type": "number" },
                      "sixMonths": { "type": "number" },
                      "oneYear": { "type": "number" }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Plan updated" },
          "404": { "description": "Plan not found" }
        }
      },
      "delete": {
        "summary": "Delete a subscription plan",
        "tags": ["Plans"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": { "type": "string" },
            "required": true
          }
        ],
        "responses": {
          "200": { "description": "Plan deleted" },
          "404": { "description": "Plan not found" }
        }
      }
    },
    "/api/v1/plans/c/{slug}": {
      "get": {
        "summary": "Get a subscription plan by slug",
        "tags": ["Plans"],
        "parameters": [
          {
            "in": "path",
            "name": "slug",
            "schema": { "type": "string" },
            "required": true
          }
        ],
        "responses": {
          "200": { "description": "Plan found" },
          "404": { "description": "Plan not found" }
        }
      }
    },
    "/api/v1/planner": {
      "post": {
        "summary": "Create or update a study planner (idempotent per student + enrollment)",
        "description": "Validates that the enrollment is active and not expired, then creates or updates the student's study planner. Computes `nextStudyDate` and `endDate` in the user's timezone (defaults to Europe/London). Resets reminder/check-in markers.\n",
        "tags": ["StudyPlanner"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StudyPlannerUpsertRequest"
              },
              "example": {
                "enrollmentId": "665f7a4b1a0e4a22b7f1a111",
                "planDuration": 30,
                "studyDays": ["Mon", "Wed", "Fri"],
                "startTime": "19:00",
                "studyHoursPerDay": 2
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Study planner created or updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StudyPlannerResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid payload or inactive/expired enrollment",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/planner/me": {
      "get": {
        "summary": "Get my study planner",
        "description": "Returns the latest planner for the authenticated student, or the specific enrollment if provided.",
        "tags": ["StudyPlanner"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "enrollmentId",
            "in": "query",
            "required": false,
            "schema": { "type": "string" },
            "description": "Filter by a specific enrollment ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Planner found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PlannerWithZoneResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/planner/{plannerId}": {
      "patch": {
        "summary": "Partially update a study planner schedule",
        "description": "Update any of the schedule fields (`planDuration`, `studyDays`, `startTime`, `studyHoursPerDay`). Recomputes `nextStudyDate` and `endDate` in the user's timezone and resets reminder/check-in markers.\n",
        "tags": ["StudyPlanner"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "plannerId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "Study Planner ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StudyPlannerPatchRequest"
              },
              "example": {
                "planDuration": 60,
                "studyDays": ["Tue", "Thu", "Sat"],
                "startTime": "20:30",
                "studyHoursPerDay": 1.5
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Planner updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StudyPlannerResponse"
                }
              }
            }
          },
          "404": {
            "description": "Planner not found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorResponse" }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete a study planner",
        "tags": ["StudyPlanner"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "plannerId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "Study Planner ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Planner deleted",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/GenericMessage" }
              }
            }
          },
          "404": {
            "description": "Planner not found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/planner/{plannerId}/pause": {
      "post": {
        "summary": "Pause a study planner",
        "description": "Sets `active=false`. Cron will stop sending reminders and check-ins.",
        "tags": ["StudyPlanner"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "plannerId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "Study Planner ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Planner paused",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Planner paused"
                    },
                    "planner": { "$ref": "#/components/schemas/StudyPlanner" }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Planner not found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/planner/{plannerId}/resume": {
      "post": {
        "summary": "Resume a study planner",
        "description": "Re-validates enrollment status/expiry, recomputes `nextStudyDate` in the user's timezone, and sets `active=true`.\n",
        "tags": ["StudyPlanner"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "plannerId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "Study Planner ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Planner resumed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Planner resumed"
                    },
                    "planner": { "$ref": "#/components/schemas/StudyPlanner" }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Enrollment inactive or expired",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorResponse" }
              }
            }
          },
          "404": {
            "description": "Planner not found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/planner/{plannerId}/check-in": {
      "post": {
        "summary": "Confirm today's study session (increments streak, may send milestone email)",
        "tags": ["StudyPlanner"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "plannerId",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Study check-in recorded and streak updated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Study check-in recorded!"
                    },
                    "currentStreak": { "type": "integer", "example": 7 },
                    "longestStreak": { "type": "integer", "example": 12 }
                  }
                }
              }
            }
          },
          "400": { "description": "Planner paused or bad request" },
          "404": { "description": "Planner not found" },
          "500": { "description": "Internal server error" }
        }
      }
    },
    "/api/v1/subscription/create-payment-intent": {
      "post": {
        "summary": "Create a Stripe Payment Intent for a subscription",
        "description": "Creates a Stripe payment intent for a selected track plan. Supports adding AI-Mentor as an add-on or as a mid-cycle activation for an existing subscription.",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["planId", "duration"],
                "properties": {
                  "planId": {
                    "type": "string",
                    "description": "ID of the selected subscription plan."
                  },
                  "duration": {
                    "type": "string",
                    "enum": [
                      "oneTime",
                      "monthly",
                      "threeMonths",
                      "sixMonths",
                      "oneYear"
                    ],
                    "description": "Duration of the subscription."
                  },
                  "includeAiMentor": {
                    "type": "boolean",
                    "description": "Whether to include AI-Mentor add-on in the payment."
                  },
                  "existingSubscriptionId": {
                    "type": "string",
                    "nullable": true,
                    "description": "(Optional) Active subscription ID if user is adding AI-Mentor mid-cycle."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Payment intent created successfully." },
          "400": { "description": "Invalid input or missing plan." },
          "500": { "description": "Failed to create payment intent." }
        }
      }
    },
    "/api/v1/subscription": {
      "get": {
        "summary": "Get all user subscriptions (Admin only)",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": { "type": "integer" },
            "description": "Page number"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": { "type": "integer" },
            "description": "Items per page"
          },
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string",
              "enum": ["pending", "successful", "failed"]
            },
            "description": "Filter by payment status"
          },
          {
            "in": "query",
            "name": "planType",
            "schema": {
              "type": "string",
              "enum": [
                "course",
                "ai-mentor",
                "bundle-essential",
                "bundle-premium"
              ]
            },
            "description": "Filter by plan type"
          },
          {
            "in": "query",
            "name": "sort",
            "schema": { "type": "string" },
            "description": "Sort by field (e.g. createdAt, -createdAt)"
          }
        ],
        "responses": { "200": { "description": "List of subscriptions" } }
      }
    },
    "/api/v1/subscription/me": {
      "get": {
        "summary": "Get current user's active subscription",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "User's active subscription",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Subscription" }
              }
            }
          },
          "404": { "description": "No active subscription found" }
        }
      }
    },
    "/api/v1/subscription/student/{userId}": {
      "get": {
        "summary": "Get active subscription for a user (Admin only)",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": { "type": "string" },
            "description": "MongoDB ObjectId of the user"
          }
        ],
        "responses": {
          "200": {
            "description": "Active subscription for the user",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "_id": {
                      "type": "string",
                      "description": "Subscription ID"
                    },
                    "user": { "type": "string", "description": "User ID" },
                    "plan": {
                      "type": "object",
                      "description": "Populated subscription plan details"
                    },
                    "planType": {
                      "type": "string",
                      "enum": [
                        "course",
                        "ai-mentor",
                        "bundle-essential",
                        "bundle-premium"
                      ]
                    },
                    "track": { "type": "string" },
                    "duration": {
                      "type": "string",
                      "enum": [
                        "monthly",
                        "threeMonths",
                        "sixMonths",
                        "oneYear",
                        "oneTime"
                      ]
                    },
                    "amount": { "type": "number" },
                    "startDate": { "type": "string", "format": "date-time" },
                    "endDate": { "type": "string", "format": "date-time" },
                    "active": { "type": "boolean" },
                    "aiMentorIncluded": { "type": "boolean" },
                    "aiMentorEndDate": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "401": { "description": "Unauthorized (missing or invalid token)" },
          "403": { "description": "Forbidden (not enough privileges)" },
          "404": { "description": "No active subscription found for this user" }
        }
      }
    },
    "/api/v1/subscription/{subscriptionId}/cancel": {
      "post": {
        "summary": "Cancel an active subscription",
        "description": "Cancels a user’s active subscription, disables AI-Mentor add-on, and deactivates the related enrollment.",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "subscriptionId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the subscription to cancel."
          }
        ],
        "responses": {
          "200": { "description": "Subscription canceled successfully." },
          "400": { "description": "Subscription already inactive." },
          "403": { "description": "Unauthorized to cancel this subscription." },
          "404": { "description": "Subscription not found." },
          "500": { "description": "Server error while canceling subscription." }
        }
      }
    },
    "/api/v1/subscription/{subscriptionId}/renew": {
      "post": {
        "summary": "Renew an existing subscription using its details",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "subscriptionId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the subscription to renew"
          }
        ],
        "responses": {
          "200": {
            "description": "Renewal payment intent created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "clientSecret": {
                      "type": "string",
                      "description": "Stripe client secret for completing payment"
                    },
                    "renewedFrom": {
                      "type": "string",
                      "description": "ID of the subscription that was renewed"
                    }
                  }
                }
              }
            }
          },
          "401": { "description": "Unauthorized - missing or invalid user" },
          "404": { "description": "Subscription not found" },
          "500": { "description": "Failed to renew subscription" }
        }
      }
    },
    "/api/v1/subscription/history": {
      "get": {
        "summary": "Get full subscription history for the authenticated enforceReadOnlyForAI, student",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Subscription history list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "history": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": { "type": "string" },
                          "planType": { "type": "string" },
                          "track": { "type": "string" },
                          "duration": { "type": "string" },
                          "amount": { "type": "number" },
                          "startDate": { "type": "string", "format": "date" },
                          "endDate": { "type": "string", "format": "date" },
                          "status": {
                            "type": "string",
                            "enum": ["active", "expired", "canceled"]
                          },
                          "aiMentorIncluded": { "type": "boolean" },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": { "description": "Failed to fetch subscription history" }
        }
      }
    },
    "/api/v1/subscription/track-stats": {
      "get": {
        "summary": "Get subscription statistics and revenue grouped by track",
        "tags": ["Subscriptions"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Subscription stats per track for daily, monthly, and yearly periods",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "daily": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/TrackStat" }
                    },
                    "monthly": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/TrackStat" }
                    },
                    "yearly": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/TrackStat" }
                    }
                  }
                }
              }
            }
          },
          "500": { "description": "Server error occurred while fetching stats" }
        }
      }
    },
    "/api/hello": {
      "get": {
        "summary": "Returns a hello message",
        "tags": ["Test"],
        "responses": {
          "200": {
            "description": "Hello from Dedatahub",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Hello from Dedatahub API!"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/user/profile": {
      "get": {
        "summary": "Get authenticated user's profile",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "User profile returned" },
          "404": { "description": "User not found" }
        }
      }
    },
    "/api/v1/users/profile": {
      "patch": {
        "summary": "Update user profile and onboarding",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "profileImage": {
                    "type": "string",
                    "description": "base64 image string"
                  },
                  "onboarding": {
                    "type": "object",
                    "properties": {
                      "phoneNumber": { "type": "string" },
                      "learningTrack": {
                        "type": "string",
                        "enum": [
                          "data-analytics",
                          "data-engineering",
                          "data-science",
                          "ai-engineering"
                        ]
                      },
                      "timeCommitment": {
                        "type": "object",
                        "properties": {
                          "schedule": { "type": "string" },
                          "hoursPerWeek": { "type": "number" }
                        }
                      },
                      "learningPreferences": {
                        "type": "object",
                        "properties": {
                          "learningStyle": { "type": "string" },
                          "problemSolving": { "type": "string" },
                          "explanationPreference": { "type": "string" },
                          "challenges": { "type": "string" }
                        }
                      },
                      "technicalBackground": {
                        "type": "object",
                        "properties": {
                          "toolsWorkedWith": {
                            "type": "array",
                            "items": { "type": "string" }
                          },
                          "aiSystemsBuilt": {
                            "type": "array",
                            "items": { "type": "string" }
                          },
                          "experienceLevel": {
                            "oneOf": [
                              { "type": "string" },
                              { "type": "object" }
                            ]
                          },
                          "performedTasks": {
                            "type": "array",
                            "items": { "type": "string" }
                          },
                          "dataTypes": {
                            "type": "array",
                            "items": { "type": "string" }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Profile updated" },
          "500": { "description": "Update failed" }
        }
      }
    },
    "/api/v1/user/admins": {
      "get": {
        "summary": "Get all admin users (superadmin only)",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": { "type": "integer" },
            "description": "Page number"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": { "type": "integer" },
            "description": "Number of items per page"
          },
          {
            "in": "query",
            "name": "sort",
            "schema": { "type": "string" },
            "description": "Field to sort by"
          },
          {
            "in": "query",
            "name": "order",
            "schema": { "type": "string", "enum": ["asc", "desc"] },
            "description": "Sort order"
          },
          {
            "in": "query",
            "name": "name",
            "schema": { "type": "string" },
            "description": "Filter by name"
          },
          {
            "in": "query",
            "name": "email",
            "schema": { "type": "string" },
            "description": "Filter by email"
          }
        ],
        "responses": { "200": { "description": "Paginated list of admins" } }
      }
    },
    "/api/v1/user/students": {
      "get": {
        "summary": "Get all student users (superadmin only)",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "query",
            "name": "stats",
            "schema": {
              "type": "string",
              "enum": ["day", "week", "month", "year"]
            },
            "description": "Get signup statistics by time range"
          },
          {
            "in": "query",
            "name": "from",
            "schema": { "type": "string", "format": "date" },
            "description": "Optional custom start date (YYYY-MM-DD). Applies to all stats types."
          },
          {
            "in": "query",
            "name": "to",
            "schema": { "type": "string", "format": "date" },
            "description": "Optional custom end date (YYYY-MM-DD). Defaults to today."
          },
          {
            "in": "query",
            "name": "page",
            "schema": { "type": "integer" },
            "description": "Pagination page number (only used if stats is not set)"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": { "type": "integer" },
            "description": "Pagination page size (only used if stats is not set)"
          }
        ],
        "responses": {
          "200": {
            "description": "Student list or signup statistics returned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "period": { "type": "string", "example": "month" },
                    "from": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-05-01T00:00:00.000Z"
                    },
                    "to": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-06-01T00:00:00.000Z"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "_id": {
                            "oneOf": [
                              { "type": "string" },
                              { "type": "integer" },
                              { "type": "object" }
                            ],
                            "description": "Group key (e.g. date, month, or hour)"
                          },
                          "count": {
                            "type": "integer",
                            "description": "Number of students that signed up"
                          },
                          "label": {
                            "type": "string",
                            "description": "Human-readable label for chart display",
                            "example": "June 2025"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/user/students/{id}": {
      "get": {
        "summary": "Get full student profile by ID",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "string" },
            "description": "Student ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Full student profile with subscription, progress, and certificates",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "student": { "type": "object" },
                    "subscription": { "type": "object" },
                    "enrollments": {
                      "type": "array",
                      "items": { "type": "object" }
                    },
                    "overview": { "type": "object" },
                    "certificates": {
                      "type": "array",
                      "items": { "type": "object" }
                    }
                  }
                }
              }
            }
          },
          "404": { "description": "Student not found" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/user/{id}": {
      "get": {
        "summary": "Get user by ID",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "string" },
            "description": "User ID"
          }
        ],
        "responses": {
          "200": { "description": "User data returned" },
          "404": { "description": "User not found" }
        }
      }
    },
    "/api/v1/user/students/export/csv": {
      "get": {
        "summary": "Export students as CSV",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "CSV file exported" } }
      }
    },
    "/api/v1/user/students/export/pdf": {
      "get": {
        "summary": "Export students as PDF",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "PDF file exported" } }
      }
    },
    "/api/v1/user/toggle-status/{userId}": {
      "patch": {
        "summary": "Activate or deactivate any user account",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID of the user to toggle status"
          }
        ],
        "responses": {
          "200": { "description": "Status toggled successfully" },
          "404": { "description": "User not found" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/api/v1/user/{userId}/logs": {
      "get": {
        "summary": "Get activity logs for a user",
        "tags": ["Users"],
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "The ID of the user whose logs to retrieve"
          }
        ],
        "responses": {
          "200": { "description": "Activity logs retrieved successfully" },
          "500": { "description": "Server error" }
        }
      }
    }
  },
  "tags": [
    { "name": "Blackboard", "description": "Student blackboard management" },
    { "name": "Subscriptions", "description": "User subscription management" }
  ]
}
